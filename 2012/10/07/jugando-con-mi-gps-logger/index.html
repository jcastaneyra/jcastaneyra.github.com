
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Jugando con mi gps logger - JCastaneyra blog</title>
  <meta name="author" content="Jose Castaneyra">

  
  <meta name="description" content="Tenía rato que no tocaba mis arduinos, ¡Desde enero! Pero recientemente
en el trabajo empezamos a platicar sobre la plataforma de Arduino, y de
como &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://jcastaneyra.com/2012/10/07/jugando-con-mi-gps-logger">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/atom.xml" rel="alternate" title="JCastaneyra blog" type="application/atom+xml">
  <!--Fonts from Google's Web font directory at http://google.com/webfonts -->
<link href='http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic' rel='stylesheet' type='text/css'>
<link href='http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic' rel='stylesheet' type='text/css'>

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-3233987-3']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <header role="banner"><hgroup>
  <div style="float: right; margin-top: 40px; z-index: -1;">
    <script type="text/javascript"><!--
      google_ad_client = "ca-pub-1928761598459347";
      /* banner */
      google_ad_slot = "4694977461";
      google_ad_width = 468;
      google_ad_height = 60;
      //-->
    </script>
    <script type="text/javascript"
      src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
    </script>
  </div>

  <h1><a href="/">JCastaneyra blog</a></h1>
  
    <h2>My ideas repo</h2>
  
</hgroup>


</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:jcastaneyra.com" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
<ul role=main-navigation>
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
  <li><a href="/about">About</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">

  <script type="text/javascript"><!--
    google_ad_client = "ca-pub-1928761598459347";
    /* post_header_large */
    google_ad_slot = "9038941466";
    google_ad_width = 728;
    google_ad_height = 15;
    //-->
  </script>
  <script type="text/javascript"
    src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
  </script>

  
  <header>
    
      <h1 class="entry-title">Jugando con mi gps logger</h1>
    
    
      <p class="meta">
        




  

<time datetime="2012-10-07T22:06:00-05:00" pubdate>Oct 7<span>th</span>, 2012</time>
        
         | <a href="#disqus_thread">Comments</a>
        
      </p>
    
  </header>


<div class="entry-content"><p>Tenía rato que no tocaba mis arduinos, ¡Desde enero! Pero recientemente
en el trabajo empezamos a platicar sobre la plataforma de Arduino, y de
como a algunos les llamaba la atención, por lo que de regreso en casa,
agarré mis arduinos, los desempolvé y los llevé al trabajo para
mostrarlos.</p>

<p><img src="https://s3-us-west-1.amazonaws.com/jcastaneyra-blog/images/logger.jpg" alt="gps
logger" /></p>

<p>Pero precisamente ahora, que estaba por viajar, traté de hacer mi
logger, digo, en realidad es simple lo que hace en general, pero la
diversión ha sido grande.</p>

<!-- more -->


<h2>Materiales y código</h2>

<p>Lo que he usado ha sido:</p>

<ol>
<li>Seeeduino stalker v2.1</li>
<li>GPS bee de Seeedstudio</li>
<li>Lithium Ion Battery de 980 mAh</li>
<li>Solar panel</li>
<li>Micro SD card de 2Gb</li>
<li>Seeeduino stalker enclosure</li>
</ol>


<p><img src="https://s3-us-west-1.amazonaws.com/jcastaneyra-blog/images/logger_components.jpg" alt="componentes" /></p>

<p>El código después de un rato de haber hecho pruebas parece simple, pero
en realidad me encontré con algunos problemas que fui resolviendo sobre
la marcha, problemas, que si me remonto a enero ya había visto y que no
tenía ni idea de como resolver.</p>

<p>El programa utiliza las librerías de TinyGPS, Wire, DS3231 y SD.</p>

<p>La librería de TinyGPS la uso para ayudarme a parsear las sentencias
NMEA que va arrojando el gps, en un principio pensé que esta librería no
me estaba ayudando, ya que el gps tardaba mucho en arrojar sentencias
correctas, claro todas mis pruebas habían sido cerca de la ventana por
lo que el gps no agarraba bien, ahora las pruebas fueron fuera de la
ventana, y puedo decir que funciona muuuuy bien. Algo curioso fue que
estuvo guardando coordenadas mientras estaba dentro del metro,
interesante.</p>

<p>Con la librería de Wire, la verdad no se para que sirve, la habré sacado
de algún sketch que vi en la red y ya no tuve tiempo para probar que
pasaba si la quitaba de mi programa.</p>

<p>La librería DS3231 la utilizo para poderme comunicar con el chip que
trae el seeeduino stalker, este chip es de tiempo real y además de
temperatura, la librería ya la había modificado para que funcionara con
Arduino 1.0, no se si Seeedstudio ya tenga una nueva librería, por lo
que esta vez me fui rápido por lo que ya sabía que funcionaba, la
librería modificada se encuentra
<a href="https://github.com/jcastaneyra/ds3231_library">aquí</a>.</p>

<p>Y por último, la librería SD la utilicé para ir escribiendo a la sd
card.</p>

<p>Algo con lo que me había encontrado también, era que no tenía ni idea de
como convertir en Arduino un flotante a string, para así poderlo mandar
por Serial, con este frágmento de código pude hacerlo:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>float current_lat = -99.123456;
</span><span class='line'>static char dtostrfbuffer[8];
</span><span class='line'>
</span><span class='line'>// convert float to array of charts
</span><span class='line'>dtostrf(current_lat,8, 6, dtostrfbuffer);</span></code></pre></td></tr></table></div></figure>


<p>Aquí está el código completo.</p>

<script src="https://gist.github.com/3845285.js"> </script>


<p>El enclosure al final se veía así.</p>

<p><img src="https://s3-us-west-1.amazonaws.com/jcastaneyra-blog/images/logger_enclosure.jpg" alt="enclosure" /></p>

<h2>Resultados</h2>

<p>Algunos de los datos que arrojó (fecha, tiempo, temperatura, latitude y
longitud):</p>

<p>51012,22431200,28.50,19.389139,-99.187347
51012,22432300,28.50,19.389179,-99.187309
51012,22433300,28.50,19.389219,-99.187302
51012,22434300,28.50,19.389210,-99.187302
51012,22435300,28.50,19.389210,-99.187309
51012,22440300,28.50,19.389191,-99.187279
51012,22441400,28.50,19.389210,-99.187271
51012,22442400,28.50,19.389219,-99.187309</p>

<p>También vi, que para poder mostrar estos datos en un mapa no era
necesario crear un programa, hay una página
<a href="http://www.gpsvisualizer.com/">http://www.gpsvisualizer.com/</a>, en donde
subes tu archivo con coordenadas, aquí también me topé con un problema,
de que mi archivo lo estaba creando con datos de fecha y temperatura al
principio de la línea y las coordenadas al final, gpsvisualizer.com
requiere que el archivo tenga las coordenadas al principio de la línea
(latitud, longitud).</p>

<p><img src="https://s3-us-west-1.amazonaws.com/jcastaneyra-blog/images/gps_logger_map.png" alt="map" /></p>

<h2>Final</h2>

<p>Al final no salieron todos las coordenadas hasta el final de mi viaje, y
eso fue porque la batería del seeeduino se acabó, pero aún así, ha sido
muy divertido ver esto funcionando, yo quería añadirle un xbee para que
en cuanto este se conectara con el xbee coordinador pudiera transmitirle
los datos o de menos su posición actual, pero no lo pude echar a andar y
creo saber porqué, en el código, interactúo con el pin 10 para poder
echar a andar la SD, y ahí precisamente es donde se conecta el xbee
shield, por lo que creo que eso afectaba a que funcionara, por lo que va
a ser necesario conectar el xbee a otros pines, pero eso será para
después.</p>
</div>


  <footer>

    <script type="text/javascript"><!--
      google_ad_client = "ca-pub-1928761598459347";
      /* post_footer_large */
      google_ad_slot = "8291555731";
      google_ad_width = 728;
      google_ad_height = 15;
      //-->
    </script>
    <script type="text/javascript"
      src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
    </script>

    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">Jose Castaneyra</span></span>

      




  

<time datetime="2012-10-07T22:06:00-05:00" pubdate>Oct 7<span>th</span>, 2012</time>
      

<span class="categories">
  
    <a class='category' href='/blog/categories/arduino/'>Arduino</a>
  
</span>


    </p>
    
      <div class="sharing">
  
  <a href="http://twitter.com/share" class="twitter-share-button" data-url="http://jcastaneyra.com/2012/10/07/jugando-con-mi-gps-logger/" data-via="jcastaneyra" data-counturl="http://jcastaneyra.com/2012/10/07/jugando-con-mi-gps-logger/" >Tweet</a>
  
  
  <div class="g-plusone" data-size="medium"></div>
  
  
    <div class="fb-like" data-send="true" data-width="450" data-show-faces="false"></div>
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/2012/01/03/testing-range-between-xbees/" title="Previous Post: Testing range between xbee's">&laquo; Testing range between xbee's</a>
      
      
    </p>
  </footer>
</article>

  <section>
    <h1>Comments</h1>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
  </section>

</div>

<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/2012/10/07/jugando-con-mi-gps-logger/">Jugando con mi gps logger</a>
      </li>
    
      <li class="post">
        <a href="/2012/01/03/testing-range-between-xbees/">Testing range between xbee's</a>
      </li>
    
      <li class="post">
        <a href="/2012/01/02/ds3231-library-update-for-arduino-1-dot-0/">DS3231 Library update for Arduino 1.0</a>
      </li>
    
      <li class="post">
        <a href="/2011/12/16/arduino-shippings/">Arduino shippings</a>
      </li>
    
      <li class="post">
        <a href="/2011/09/21/macs-en-venta/">Macs usadas en Venta</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>Github Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating...</li>
  </ul>
  
  <a href="https://github.com/jcastaneyra">@jcastaneyra</a> on Github
  
  <script type="text/javascript">
    $.domReady(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'jcastaneyra',
            count: 0,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>


<section>
  <h1>Latest Tweets</h1>
  <ul id="tweets">
    <li class="loading">Status updating...</li>
  </ul>
  <script type="text/javascript">
    $.domReady(function(){
      getTwitterFeed("jcastaneyra", 4, true);
    });
  </script>
  <script src="/javascripts/twitter.js" type="text/javascript"> </script>
  
    <a href="http://twitter.com/jcastaneyra" class="twitter-follow-button" data-width="208px" data-show-count="true">Follow @jcastaneyra</a>
  
</section>


<section>
  <h1>On Delicious</h1>
  <div id="delicious"></div>
  <script type="text/javascript" src="http://feeds.delicious.com/v2/json/jcastaneyra?count=3&amp;sort=date&amp;callback=renderDeliciousLinks"></script>
  <p><a href="http://delicious.com/jcastaneyra">My Delicious Bookmarks &raquo;</a></p>
</section>


<section class="googleplus googleplus-hidden">
  <h1>
    <a href="https://plus.google.com/112262934273275148051?rel=author">
      <img src="http://www.google.com/images/icons/ui/gprofile_button-32.png" width="32" height="32">
      Google+
    </a>
  </h1>
</section>


<section>
  <h1>AdSense</h1>
  <script type="text/javascript"><!--
    google_ad_client = "ca-pub-1928761598459347";
    /* 160x600, creado 13/09/08 */
    google_ad_slot = "8245795082";
    google_ad_width = 160;
    google_ad_height = 600;
    //-->
  </script>
  <script type="text/javascript"
    src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
  </script>
</section>

  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2012 - Jose Castaneyra -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'jcastaneyra';
      
        
        //var disqus_developer = 1;
        if(typeof(custom_disqus_identifier) != "undefined") {
          var disqus_identifier = custom_disqus_identifier;
        } else {
          //var disqus_identifier = 'http://jcastaneyra.com/2012/10/07/jugando-con-mi-gps-logger';
          var disqus_identifier = 'http://jcastaneyra.com/2012/10/07/jugando-con-mi-gps-logger/';
        }

        if(typeof(custom_disqus_url) != "undefined") {
          var disqus_url = custom_disqus_url;
        } else {
          //var disqus_url = 'http://jcastaneyra.com/2012/10/07/jugando-con-mi-gps-logger';
          var disqus_url = 'http://jcastaneyra.com/2012/10/07/jugando-con-mi-gps-logger/';
        }

        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>



<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) {return;}
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/all.js#appId=212934732101925&xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>



  <script type="text/javascript">
    (function() {
      var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
      script.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    })();
  </script>



  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
